
Original matrix A = 
[[cMatrix]]
| 3 | 2 | 6 | 5 | 7 | 
| 6 | 2 | 6 | 0 | 5 | 
| 3 | 2 | 8 | 9 | 0 | 

Transformed matrix B = 
[[cMatrix]]
| -6.30602 | -3.16958 | -11.1466 | -8.61366 | -4.32648 | 
| 2.34212 | -0.05082 | -0.88958 | -5.63186 | 0.78978 | 
| 2.95781 | 1.39685 | 3.31077 | 0.29502 | 7.39309 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 2110.43 |
| 1508.47 |
| 929.41 |
Alpha 2755.58 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 4866.01 |
| 1508.47 |
| 929.41 |
Vector v at 0 iter: 

Vector contents:
| 0.939648 |
| 0.291293 |
| 0.179473 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -0.765876 | -0.547425 | -0.337283 | 
| -0.547425 | 0.830297 | -0.104559 | 
| -0.337283 | -0.104559 | 0.935579 | 
Q_heap(0)

[[cMatrix]]
| -0.765876 | -0.547425 | -0.337283 | 
| -0.547425 | 0.830297 | -0.104559 | 
| -0.337283 | -0.104559 | 0.935579 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 659.895 |
| 567.839 |
Alpha 870.576 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1530.47 |
| 567.839 |
Vector v at 1 iter: 

Vector contents:
| 0.937549 |
| 0.347852 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -0.757998 | -0.652257 | 
| -0.652257 | 0.757998 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -0.757998 | -0.652257 | 
| 0 | -0.652257 | 0.757998 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4222.07 |
| 765.569 |
| -79.7788 |
Alpha 4291.66 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8513.73 |
| 765.569 |
| -79.7788 |
Vector v at 0 iter: 

Vector contents:
| 0.995938 |
| 0.0895564 |
| -0.00933254 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -0.983785 | -0.178385 | 0.0185893 | 
| -0.178385 | 0.983959 | 0.00167158 | 
| 0.0185893 | 0.00167158 | 0.999826 | 
Q_heap(0)

[[cMatrix]]
| -0.983785 | -0.178385 | 0.0185893 | 
| -0.178385 | 0.983959 | 0.00167158 | 
| 0.0185893 | 0.00167158 | 0.999826 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.586 |
| -109.765 |
Alpha 799.16 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1590.75 |
| -109.765 |
Vector v at 1 iter: 

Vector contents:
| 0.997628 |
| -0.0688385 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -0.990523 | 0.13735 | 
| 0.13735 | 0.990523 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -0.990523 | 0.13735 | 
| 0 | 0.13735 | 0.990523 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4388.8 |
| 145.031 |
| 3.0755 |
Alpha 4391.2 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8780 |
| 145.031 |
| 3.0755 |
Vector v at 0 iter: 

Vector contents:
| 0.999864 |
| 0.0165161 |
| 0.000350237 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -0.999454 | -0.0330277 | -0.000700379 | 
| -0.0330277 | 0.999454 | -1.15691e-05 | 
| -0.000700379 | -1.15691e-05 | 1 | 
Q_heap(0)

[[cMatrix]]
| -0.999454 | -0.0330277 | -0.000700379 | 
| -0.0330277 | 0.999454 | -1.15691e-05 | 
| -0.000700379 | -1.15691e-05 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.528 |
| 22.3352 |
Alpha 791.843 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.37 |
| 22.3352 |
Vector v at 1 iter: 

Vector contents:
| 0.999901 |
| 0.0141047 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -0.999602 | -0.0282066 | 
| -0.0282066 | 0.999602 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -0.999602 | -0.0282066 | 
| 0 | -0.0282066 | 0.999602 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4394.46 |
| 26.1717 |
| -0.114294 |
Alpha 4394.54 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8789 |
| 26.1717 |
| -0.114294 |
Vector v at 0 iter: 

Vector contents:
| 0.999996 |
| 0.00297776 |
| -1.30042e-05 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -0.999982 | -0.0059555 | 2.60082e-05 | 
| -0.0059555 | 0.999982 | 7.74465e-08 | 
| 2.60082e-05 | 7.74465e-08 | 1 | 
Q_heap(0)

[[cMatrix]]
| -0.999982 | -0.0059555 | 2.60082e-05 | 
| -0.0059555 | 0.999982 | 7.74465e-08 | 
| 2.60082e-05 | 7.74465e-08 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.686 |
| -4.60038 |
Alpha 791.699 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.38 |
| -4.60038 |
Vector v at 1 iter: 

Vector contents:
| 0.999996 |
| -0.0029054 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -0.999983 | 0.00581077 | 
| 0.00581077 | 0.999983 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -0.999983 | 0.00581077 | 
| 0 | 0.00581077 | 0.999983 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4394.64 |
| 4.7151 |
| 0.00424179 |
Alpha 4394.65 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8789.29 |
| 4.7151 |
| 0.00424179 |
Vector v at 0 iter: 

Vector contents:
| 1 |
| 0.00053646 |
| 4.82609e-07 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -0.999999 | -0.00107292 | -9.65218e-07 | 
| -0.00107292 | 0.999999 | -5.17801e-10 | 
| -9.65218e-07 | -5.17801e-10 | 1 | 
Q_heap(0)

[[cMatrix]]
| -0.999999 | -0.00107292 | -9.65218e-07 | 
| -0.00107292 | 0.999999 | -5.17801e-10 | 
| -9.65218e-07 | -5.17801e-10 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.698 |
| 0.947686 |
Alpha 791.699 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.4 |
| 0.947686 |
Vector v at 1 iter: 

Vector contents:
| 1 |
| 0.000598514 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -0.999999 | -0.00119703 | 
| -0.00119703 | 0.999999 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -0.999999 | -0.00119703 | 
| 0 | -0.00119703 | 0.999999 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4394.65 |
| 0.849431 |
| -0.000157418 |
Alpha 4394.65 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8789.3 |
| 0.849431 |
| -0.000157418 |
Vector v at 0 iter: 

Vector contents:
| 1 |
| 9.66437e-05 |
| -1.79102e-08 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -1 | -0.000193287 | 3.58203e-08 | 
| -0.000193287 | 1 | 3.46181e-12 | 
| 3.58203e-08 | 3.46181e-12 | 1 | 
Q_heap(0)

[[cMatrix]]
| -1 | -0.000193287 | 3.58203e-08 | 
| -0.000193287 | 1 | 3.46181e-12 | 
| 3.58203e-08 | 3.46181e-12 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.699 |
| -0.195224 |
Alpha 791.699 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.4 |
| -0.195224 |
Vector v at 1 iter: 

Vector contents:
| 1 |
| -0.000123294 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -1 | 0.000246588 | 
| 0.000246588 | 1 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -1 | 0.000246588 | 
| 0 | 0.000246588 | 1 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4394.65 |
| 0.153025 |
| 5.84194e-06 |
Alpha 4394.65 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8789.3 |
| 0.153025 |
| 5.84194e-06 |
Vector v at 0 iter: 

Vector contents:
| 1 |
| 1.74104e-05 |
| 6.64665e-10 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -1 | -3.48209e-05 | -1.32933e-09 | 
| -3.48209e-05 | 1 | -2.31442e-14 | 
| -1.32933e-09 | -2.31442e-14 | 1 | 
Q_heap(0)

[[cMatrix]]
| -1 | -3.48209e-05 | -1.32933e-09 | 
| -3.48209e-05 | 1 | -2.31442e-14 | 
| -1.32933e-09 | -2.31442e-14 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.699 |
| 0.0402161 |
Alpha 791.699 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.4 |
| 0.0402161 |
Vector v at 1 iter: 

Vector contents:
| 1 |
| 2.53986e-05 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -1 | -5.07973e-05 | 
| -5.07973e-05 | 1 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -1 | -5.07973e-05 | 
| 0 | -5.07973e-05 | 1 | 
===========================QR SECTION==========================
Vector x at 0 iter: 

Vector contents:
| 4394.65 |
| 0.0275676 |
| -2.16801e-07 |
Alpha 4394.65 at 0 iter: 

Vector u at 0 iter: 

Vector contents:
| 8789.3 |
| 0.0275676 |
| -2.16801e-07 |
Vector v at 0 iter: 

Vector contents:
| 1 |
| 3.1365e-06 |
| -2.46665e-11 |
Q_tmp at 0 iter: 

[[cMatrix]]
| -1 | -6.273e-06 | 4.93329e-11 | 
| -6.273e-06 | 1 | 1.54733e-16 | 
| 4.93329e-11 | 1.54733e-16 | 1 | 
Q_heap(0)

[[cMatrix]]
| -1 | -6.273e-06 | 4.93329e-11 | 
| -6.273e-06 | 1 | 1.54733e-16 | 
| 4.93329e-11 | 1.54733e-16 | 1 | 
===========================QR SECTION==========================
Vector x at 1 iter: 

Vector contents:
| 791.699 |
| -0.00828454 |
Alpha 791.699 at 1 iter: 

Vector u at 1 iter: 

Vector contents:
| 1583.4 |
| -0.00828454 |
Vector v at 1 iter: 

Vector contents:
| 1 |
| -5.23213e-06 |
Q_tmp at 1 iter: 

[[cMatrix]]
| -1 | 1.04643e-05 | 
| 1.04643e-05 | 1 | 
Q_heap(1)

[[cMatrix]]
| 1 | 0 | 0 | 
| 0 | -1 | 1.04643e-05 | 
| 0 | 1.04643e-05 | 1 | 
===========================EIGEN SECTION==========================
Eigenvalue matrix after 7 iterations of the QR algorithm
[[cMatrix]]
| 4394.65 | 0.0275676 | -2.16801e-07 | 
| 0.0275676 | 791.699 | -0.00828454 | 
| -2.16801e-07 | -0.00828454 | 163.09 | 
Eigenvector matrix Q_0:
[[cMatrix]]
| -0.765876 | 0.634943 | 0.101402 | 
| -0.547425 | -0.561164 | -0.620822 | 
| -0.337283 | -0.530983 | 0.777366 | 
Eigenvector matrix after multiplying by Q_1:
[[cMatrix]]
| 0.642078 | -0.742215 | 0.191972 | 
| 0.627112 | 0.364449 | -0.68841 | 
| 0.440984 | 0.5624 | 0.699456 | 
Eigenvector matrix Q_1
[[cMatrix]]
| -0.983785 | 0.179248 | -0.00608819 | 
| -0.178385 | -0.974404 | 0.136803 | 
| 0.0185893 | 0.135671 | 0.99058 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_2:
[[cMatrix]]
| -0.617348 | 0.757313 | 0.212977 | 
| -0.638324 | -0.323979 | -0.698269 | 
| -0.459808 | -0.567023 | 0.683419 | 
Eigenvector matrix Q_2
[[cMatrix]]
| -0.999454 | 0.0330344 | 0.000231501 | 
| -0.0330277 | -0.999056 | -0.0282028 | 
| -0.000700379 | -0.0281951 | 0.999602 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_3:
[[cMatrix]]
| 0.612832 | -0.759726 | 0.217379 | 
| 0.640224 | 0.316109 | -0.700135 | 
| 0.463195 | 0.568236 | 0.680116 | 
Eigenvector matrix Q_3
[[cMatrix]]
| -0.999982 | 0.00595555 | -8.59824e-06 | 
| -0.0059555 | -0.999965 | 0.00581074 | 
| 2.60082e-05 | 0.00581069 | 0.999983 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_4:
[[cMatrix]]
| -0.612017 | 0.760122 | 0.218288 | 
| -0.640562 | -0.314583 | -0.700512 | 
| -0.463805 | -0.568553 | 0.679436 | 
Eigenvector matrix Q_4
[[cMatrix]]
| -0.999999 | 0.00107292 | 3.19099e-07 | 
| -0.00107292 | -0.999999 | -0.00119703 | 
| -9.65218e-07 | -0.00119703 | 0.999999 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_5:
[[cMatrix]]
| 0.61187 | -0.760186 | 0.218476 | 
| 0.640623 | 0.314287 | -0.70059 | 
| 0.463915 | 0.568631 | 0.679295 | 
Eigenvector matrix Q_5
[[cMatrix]]
| -1 | 0.000193287 | -1.18421e-08 | 
| -0.000193287 | -1 | 0.000246588 | 
| 3.58203e-08 | 0.000246588 | 1 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_6:
[[cMatrix]]
| -0.611844 | 0.760197 | 0.218514 | 
| -0.640634 | -0.314229 | -0.700606 | 
| -0.463935 | -0.568649 | 0.679267 | 
Eigenvector matrix Q_6
[[cMatrix]]
| -1 | 3.48209e-05 | 4.39473e-10 | 
| -3.48209e-05 | -1 | -5.07973e-05 | 
| -1.32933e-09 | -5.07973e-05 | 1 | 
Number of iterations: 7
Eigenvector matrix after multiplying by Q_7:
[[cMatrix]]
| 0.611839 | -0.760198 | 0.218522 | 
| 0.640636 | 0.314217 | -0.700609 | 
| 0.463938 | 0.568653 | 0.679261 | 
Eigenvector matrix Q_7
[[cMatrix]]
| -1 | 6.273e-06 | -1.63093e-11 | 
| -6.273e-06 | -1 | 1.04643e-05 | 
| 4.93329e-11 | 1.04643e-05 | 1 | 
Number of iterations: 7
===========================SVD SECTION==========================
A*A' = 
[[cMatrix]]
| 2110.43 | 1508.47 | 929.41 | 
| 1508.47 | 1961.85 | 1370.01 | 
| 929.41 | 1370.01 | 1277.16 | 

Eigenvectors of A*A' (U) = 

[[cMatrix]]
| 0.611839 | -0.760198 | 0.218522 | 
| 0.640636 | 0.314217 | -0.700609 | 
| 0.463938 | 0.568653 | 0.679261 | 

Singular values of A'*A (S) = 

[[cMatrix]]
| 66.2922 | 0 | 0 | 
| 0 | 28.1371 | 0 | 
| 0 | 0 | 12.7707 | 

Eigenvectors of A'*A (V) = 

[[cMatrix]]
| -0.0540041 | 0.527339 | 0.84794 | 
| 0.333364 | 0.809978 | -0.482496 | 
| -0.94125 | 0.256613 | -0.219537 | 


Q_U = 
[[cMatrix]]
| -1 | 6.273e-06 | -1.63093e-11 | 
| -6.273e-06 | -1 | 1.04643e-05 | 
| 4.93329e-11 | 1.04643e-05 | 1 | 
Q_U iter = 7
Q_V = 
[[cMatrix]]
| 0 | 0 | 0 | 0 | 
| 0 | 0 | 0 | 0 | 
| 0 | 0 | 0 | 0 | 
| 0 | 0 | 0 | 0 | 
Q_V iter = 2685004



Original matrix A = U*S*V' = 
[[cMatrix]]
| -11.1038 | -5.15045 | -44.2788 | 
| -5.21794 | 25.6359 | -35.7411 | 
| 14.1322 | 19.0272 | -26.7471 | 
===========================KABSCH SECTION==========================

Centroid of A = 
Vector contents:
| 4.6 |
| 3.8 |
| 4.4 |

Centroid of B = 
Vector contents:
| -6.71247 |
| -0.688072 |
| 3.07071 |

A - centroidA =
[[cMatrix]]
| -1.6 | -2.6 | 1.4 | 0.4 | 2.4 | 
| 2.2 | -1.8 | 2.2 | -3.8 | 1.2 | 
| -1.4 | -2.4 | 3.6 | 4.6 | -4.4 | 

B - centroidB =
[[cMatrix]]
| 0.406454 | 3.54289 | -4.43416 | -1.90119 | 2.38599 | 
| 3.03019 | 0.637252 | -0.201508 | -4.94379 | 1.47785 | 
| -0.112898 | -1.67386 | 0.240062 | -2.77569 | 4.32238 | 

H = 
[[cMatrix]]
| -11.1038 | -5.15045 | -44.2788 | 
| -5.21794 | 25.6359 | -35.7411 | 
| 14.1322 | 19.0272 | -26.7471 | 

Det of R = 1

Rotation matrix = 
[[cMatrix]]
| -0.24863 | -0.462972 | 0.85079 | 
| -0.517214 | 0.806115 | 0.287517 | 
| -0.818944 | -0.368557 | -0.439881 | 

R * B = 
[[cMatrix]]
| 3 | 2.00001 | 6.00001 | 5.00001 | 7.00001 | 
| 6 | 2 | 5.99999 | 3.75341e-06 | 5.00001 | 
| 2.99999 | 1.99999 | 7.99998 | 8.99999 | -1.58877e-05 | 

Translation matrix = 
Vector contents:
| -8.48935e-06 |
| -1.33778e-06 |
| 1.49221e-05 |

Result of the algorithm: 

R * B + t = A
[[cMatrix]]
| 3 | 2 | 6 | 5 | 7.00001 | 
| 6 | 2 | 5.99999 | 2.41562e-06 | 5.00001 | 
| 3 | 2 | 7.99999 | 9 | -9.65588e-07 | 

Original matrix A = 
[[cMatrix]]
| 3 | 2 | 6 | 5 | 7 | 
| 6 | 2 | 6 | 0 | 5 | 
| 3 | 2 | 8 | 9 | 0 | 

Transformed matrix B = 
[[cMatrix]]
| -6.30602 | -3.16958 | -11.1466 | -8.61366 | -4.32648 | 
| 2.34212 | -0.05082 | -0.88958 | -5.63186 | 0.78978 | 
| 2.95781 | 1.39685 | 3.31077 | 0.29502 | 7.39309 | 
